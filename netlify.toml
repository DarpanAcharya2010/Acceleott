# ======================================
# ✅ Netlify Config for Acceleott (Frontend + Serverless Backend)
# ======================================

[build]
  base = "acceleott-mueller"          # frontend folder
  command = "npm install && npm run build"
  publish = "acceleott-mueller/dist"  # ✅ corrected publish path
  functions = "../acceleott-backend/netlify/functions"

# ======================================
# ✅ Environment Variables (managed in Netlify Dashboard)
# ======================================
# Add these in Netlify → Site Settings → Environment Variables
# MONGODB_URI, JWT_SECRET, EMAIL_USER, EMAIL_PASS, FRONTEND_URL, etc.

# ======================================
# ✅ Redirects
# - All /api/* routes go to backend (serverless)
# - Everything else → index.html (for React Router)
# ======================================
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/server"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# ======================================
# ✅ Node.js Version
# (matches your backend package.json engines)
# ======================================
[build.environment]
  NODE_VERSION = "18"

# ======================================
# ✅ Caching
# ======================================
[functions]
  node_bundler = "esbuild"
  included_files = ["acceleott-backend/**"]
